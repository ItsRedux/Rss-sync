bindings:
- name: Peleg
  source: Peleg
  target: This Week List
- name: Hayot-Kiss
  source: Hayot-Kiss
  target: This Week List
- name: The-Great-Game
  source: The-Great-Game
  target: This Week List
- name: Propdo
  source: Propdo
  target: This Week List

targets:
  - name: This Week List
    trello:
      token: '{{ env.Getenv "TRELLO_TOKEN" }}'
      key: '{{ env.Getenv "TRELLO_KEY" }}'
      board-id: '{{ env.Getenv "TRELLO_BOARD_ID" }}'
      list-id: '{{ env.Getenv "TRELLO_LIST_ID" }}'
      card:
        title: '[{{ .source.name }}] Listen to: {{ .item.title }}'
        description: "{{ .feed.title }}\nLink: {{ .item.link }}\nDescription: {{ .item.description }}"
        labels:
          - 5cdafec7c65fab3704aaf9bc
          - 5cdafe82e540515e358d86e1

filters:
  - &just-released-RFC1123 '{{ ((time.Now).Add (time.Hour -24)).Before (time.Parse "Mon, 02 Jan 2006 15:04:05 MST" .item.published) }}'
  - &just-released-RFC1123Z '{{ ((time.Now).Add (time.Hour -24)).Before (time.Parse "Mon, 02 Jan 2006 15:04:05 -0700" .item.published) }}'
  - &just-released-RFC3339 '{{ ((time.Now).Add (time.Hour -24)).Before (time.Parse "2006-01-02T15:04:05Z" .item.publishedParsed) }}'

sources:
- name: Peleg
  rss:
    url: https://greatgame.blog/feed/peleg
    auth:
      username: '{{ env.Getenv "PELEG_USERNAME" }}'
      password: '{{ env.Getenv "PELEG_PASSWORD" }}'
  filter:
    just-released: *just-released-RFC3339
- name: Hayot-Kiss
  rss:
    url: https://www.omnycontent.com/d/playlist/23f697a0-7e6a-4e96-a223-a82c00962b12/dbe32976-5401-4c93-87ed-a919008d58ae/1ea69f94-8d46-4ff2-aaca-a919008d58b8/podcast.rss
  filter:
    just-released: *just-released-RFC1123Z
- name: The-Great-Game
  rss:
    url: https://greatgame.blog/feed/
  filter:
    just-released: *just-released-RFC1123Z
- name: Propdo
  rss:
    url: https://anchor.fm/s/84ee848/podcast/rss
  filter:
    just-released: *just-released-RFC1123